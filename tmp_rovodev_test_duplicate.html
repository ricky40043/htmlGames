<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¬è©¦é˜²é‡è¤‡åŠŸèƒ½</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; }
        .error { background-color: #f8d7da; }
        button { padding: 10px 20px; margin: 10px 0; font-size: 16px; }
    </style>
</head>
<body>
    <h1>é˜²é‡è¤‡åŠŸèƒ½æ¸¬è©¦</h1>
    <button onclick="runTests()">é–‹å§‹æ¸¬è©¦</button>
    <div id="results"></div>

    <script src="two-player-quiz/questions_complete.js"></script>
    <script>
        function runTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';
            
            function addResult(message, isSuccess = true) {
                const div = document.createElement('div');
                div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
                div.textContent = message;
                resultsDiv.appendChild(div);
            }
            
            try {
                // æ¸¬è©¦1ï¼šæª¢æŸ¥è®Šæ•¸æ˜¯å¦å­˜åœ¨
                if (typeof questionBank !== 'undefined') {
                    addResult(`âœ… questionBank å­˜åœ¨ï¼ŒåŒ…å« ${questionBank.length} é¡Œ`);
                } else {
                    addResult('âŒ questionBank æœªå®šç¾©', false);
                    return;
                }
                
                if (typeof getQuestionsByFilter !== 'undefined') {
                    addResult('âœ… getQuestionsByFilter å‡½æ•¸å­˜åœ¨');
                } else {
                    addResult('âŒ getQuestionsByFilter å‡½æ•¸æœªå®šç¾©', false);
                    return;
                }
                
                if (typeof resetUsedQuestions !== 'undefined') {
                    addResult('âœ… resetUsedQuestions å‡½æ•¸å­˜åœ¨');
                } else {
                    addResult('âŒ resetUsedQuestions å‡½æ•¸æœªå®šç¾©', false);
                    return;
                }
                
                // æ¸¬è©¦2ï¼šé‡ç½®ä¸¦æ¸¬è©¦é˜²é‡è¤‡
                resetUsedQuestions();
                addResult('âœ… å·²é‡ç½®ä½¿ç”¨éçš„é¡Œç›®');
                
                // æ¸¬è©¦3ï¼šç²å–ç¬¬ä¸€æ‰¹é¡Œç›®
                const batch1 = getQuestionsByFilter('all', 'all', 10);
                addResult(`âœ… ç¬¬ä¸€æ‰¹ç²å–äº† ${batch1.length} é¡Œ`);
                addResult(`ğŸ“‹ ç¬¬ä¸€æ‰¹ID: ${batch1.map(q => q.id).join(', ')}`);
                
                // æ¸¬è©¦4ï¼šç²å–ç¬¬äºŒæ‰¹é¡Œç›®
                const batch2 = getQuestionsByFilter('all', 'all', 10);
                addResult(`âœ… ç¬¬äºŒæ‰¹ç²å–äº† ${batch2.length} é¡Œ`);
                addResult(`ğŸ“‹ ç¬¬äºŒæ‰¹ID: ${batch2.map(q => q.id).join(', ')}`);
                
                // æ¸¬è©¦5ï¼šæª¢æŸ¥é‡è¤‡
                const ids1 = batch1.map(q => q.id);
                const ids2 = batch2.map(q => q.id);
                const duplicates = ids1.filter(id => ids2.includes(id));
                
                if (duplicates.length === 0) {
                    addResult('âœ… æ²’æœ‰é‡è¤‡é¡Œç›®ï¼Œé˜²é‡è¤‡åŠŸèƒ½æ­£å¸¸');
                } else {
                    addResult(`âŒ ç™¼ç¾é‡è¤‡é¡Œç›®: ${duplicates.join(', ')}`, false);
                }
                
                // æ¸¬è©¦6ï¼šæ¸¬è©¦é›£åº¦ç¯©é¸
                resetUsedQuestions();
                const easyQuestions = getQuestionsByFilter('easy', 'all', 5);
                const allEasy = easyQuestions.every(q => q.difficulty === 'easy');
                
                if (allEasy && easyQuestions.length === 5) {
                    addResult('âœ… é›£åº¦ç¯©é¸åŠŸèƒ½æ­£å¸¸');
                } else {
                    addResult(`âŒ é›£åº¦ç¯©é¸æœ‰å•é¡Œ: ${easyQuestions.map(q => q.difficulty).join(', ')}`, false);
                }
                
                // æ¸¬è©¦7ï¼šæ¸¬è©¦å¤§é‡ä½¿ç”¨
                resetUsedQuestions();
                let totalUsed = 0;
                let hasError = false;
                
                for (let i = 0; i < 10; i++) {
                    const batch = getQuestionsByFilter('all', 'all', 20);
                    totalUsed += batch.length;
                    
                    if (batch.length < 20) {
                        addResult(`âš ï¸ ç¬¬${i+1}æ¬¡åªç²å–äº†${batch.length}é¡Œï¼ˆå¯èƒ½æ˜¯é¡Œç›®ç”¨å®Œäº†ï¼‰`);
                        break;
                    }
                }
                
                addResult(`âœ… å¤§é‡æ¸¬è©¦å®Œæˆï¼Œç¸½å…±ä½¿ç”¨äº† ${totalUsed} é¡Œ`);
                
            } catch (error) {
                addResult(`âŒ æ¸¬è©¦éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤: ${error.message}`, false);
            }
        }
    </script>
</body>
</html>